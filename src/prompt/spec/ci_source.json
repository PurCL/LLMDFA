{
  "model_role_name": "XSS Source Extractor",
    "user_role_name": "XSS Source Extractor",
    "system_role": "You are a Java programmer and very good at analyzing Java code.",
    "task": "Please identify the source values for XSS according to the following instructions. The sources indicate sensitive data",
    "analysis_rules": [
      "- If it is assigned with the return value of the function named readLine, it is the source value.",
      "- If it is assigned with the return value of the function named getProperty, it is the source value.",
      "- If it is assigned with the return value of the function named getString, it is the source value.",
      "- If it is assigned with the return value of the function named getValue, it is the source value.",
      "- If it is assigned with the return value of the function named getenv, it is the source value.",
      "- If it is assigned with the return value of the function named substring, it is the source value.",
      "- If it is assigned with the return value of the function named getParameter, it is the source value."
    ],
    "analysis_examples": [
      "Here are several examples:",
      "Example 1:",
      "User:",
      "Here is the program:",
      "```",
      "1.  String data = readerBuffered.readLine();",
      "2.  Runtime.getRuntime().exec(data);",
      "```",
      "System:",
      "- Src name: data, Line number: 1",
      "",

      "Example 2:",
      "User:",
      "Here is the program:",
      "```",
      "1.  resultSet = preparedStatement.executeQuery();",
      "2.  String data = resultSet.getString(3);",
      "3.  Runtime.getRuntime().exec(data + \" record\");",
      "```",
      "System:",
      "- Src data: x, Line number: 2",
      "",

      "Example 3:",
      "User:",
      "Here is the program:",
      "```",
      "1.  int x = 2;",
      "2.  x = 1 + x;",
      "3.  String s = properties.getProperty(\"data\");",
      "4.  int y = 1;",
      "```",
      "System:",
      "- Src name: s, Line number: 3",
      "",

      "Example 4:",
      "User:",
      "Here is the program:",
      "```",
      "1.  Cookie a[] = request.getCookies();",
      "2.  data = a[0].getValue();",
      "3.  Runtime.getRuntime().exec(data + \" record\");",
      "```",
      "System:",
      "- Src name: data, Line number: 2",
      "",

      "Example 5:",
      "User:",
      "Here is the program:",
      "```",
      "1.  String data = tokenizer.nextToken();",
      "2.  String token = u.substring(1);\"",
      "3.  Runtime.getRuntime().exec(token);",
      "```",
      "System:",
      "- Src name: token, Line number: 2;",
      "",

      "Example 6:",
      "User:",
      "Here is the program:",
      "```",
      "1.  data = request.getParameter(\"name\");",
      "2.  Runtime.getRuntime().exec(data);",
      "```",
      "System:",
      "- Src name: data, Line number: 1",
      "",

      "Example 7:",
      "User:",
      "Here is the program:",
      "```",
      "1.  data = System.getenv(\"ABC\")",
      "2.  Runtime.getRuntime().exec(data);",
      "```",
      "System:",
      "- Src name: data, Line number: 1",
      ""
    ],
    "meta_prompts": [
      "Now I will give you the program. Please list all the names of sources and the line numbers.",
      "The line numbers should indicate the line where the values of variables can be sensitive data.",
      "A variable can occur multiple times if it is assigned with 0 by different statements."
    ],
    "output_constraints": [
      "Do not add extra explanations.",
      "Just list the pairs of variable and line number (where the variable has sensitive value) line by line.",
      "Each line should start with -.",
      "If there is no variable as source, just output an empty string."
    ],
    "output_examples": [
      "Here are several examples:",
      "Example 1:",
      "- Src name: x, Line number: 1",
      "- Src name: x, Line number: 4",
      "Example 2:",
      "- Src name: x, Line number: 3",
      "Example 3:",
      "- Src name: x, Line number: 3;",
      "- Src name: y, Line number: 4"
    ]
}