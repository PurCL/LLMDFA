{
  "model_role_name": "XSS Detector",
    "user_role_name": "XSS Detector",
    "system_role": "You are a Java programmer and very good at analyzing Java code.",
    "task": "Please detect the xss bugs according to the following instructions.",
    "analysis_rules": [
      "- The value of sensitive data can be produced by the return value of six methods, namely readline, getProperty, getCookies, executeQuery, nextToken, and getParameter.",
      "- If one operand in an expression is sensitive data, then the expression is also sensitive data",
      "- If the parameter of println is sensitive data, then the XSS bug occurs."
    ],
    "analysis_examples": [
      "Here are several examples:",
      "Example 1:",
      "User:",
      "Here is the program:",
      "```",
      "1.  String data = readerBuffered.readLine();",
      "2.  writer.println(data);",
      "```",
      "Please detect the xss bugs in the program step by step.",
      "System:",
      "There is 1 xss bug in the program:",
      "Bug 1: The value of data at the line 1 is produced by the return value of readLine. It makes the parameter of println sensitive. Hence, there is the XSS bug at the line 2.",
      "",

      "Example 2:",
      "User:",
      "Here is the program:",
      "```",
      "1.  resultSet = preparedStatement.executeQuery();",
      "2.  String data = resultSet.getString(3);",
      "3.  writer.println(data + \" record\");",
      "```",
      "Please detect the xss bugs in the program step by step.",
      "System:",
      "There is 1 xss bug in the program:",
      "Bug 1: resultSet at the line 1 is produced by the return value of executeQuery. It makes the data defined at line 2 sensitive. Furthermore, the parameter of println, i.e., data + \" record\", become sensitive. Hence, there is the XSS bug at the line 3.",
      "",

      "Example 3:",
      "User:",
      "Here is the program:",
      "```",
      "1.  Cookie a[] = request.getCookies();",
      "2.  data = a[0].getValue();",
      "3.  writer.println(data + \" record\");",
      "```",
      "Please detect the xss bugs in the program step by step.",
      "System:",
      "There is 1 xss bug in the program:",
      "Bug 1: a at the line 1 is produced by the return value of getCookies. It further makes `data` at line 2 sensitive. Hence, the parameter of println, i.e., data + \" record\", become sensitive. There is the XSS bug at the line 3.",
      "",

      "Example 4:",
      "User:",
      "Here is the program:",
      "```",
      "1.  String data = tokenizer.nextToken();",
      "2.  writer.println(data);",
      "```",
      "Please detect the xss bugs in the program step by step.",
      "System:",
      "There is 1 xss bug in the program:",
      "Bug 1: The value of data at the line 1 is produced by the return value of nextToken. It makes the parameter of println sensitive. Hence, there is the XSS bug at the line 2.",
      "",

      "Example 5:",
      "User:",
      "Here is the program:",
      "```",
      "1.  data = properties.getProperty(\"data\");",
      "2.  writer.println(data);",
      "```",
      "Please detect the xss bugs in the program step by step.",
      "System:",
      "There is 1 xss bug in the program:",
      "Bug 1: The value of data at the line 1 is produced by the return value of getProperty. It makes the parameter of println sensitive. Hence, there is the XSS bug at the line 2.",
      "",

      "Example 6:",
      "User:",
      "Here is the program:",
      "```",
      "1.  data = request.getParameter(\"name\");",
      "2.  writer.println(data);",
      "```",
      "Please detect the xss bugs in the program step by step.",
      "System:",
      "There is 1 xss bug in the program:",
      "Bug 1: The value of data at the line 1 is produced by the return value of getParameter. It makes the parameter of println sensitive. Hence, there is the XSS bug at the line 2.",
      ""
    ],
    "meta_prompts": [
      "Now I will give you the program as follows: \n ```\n<PROGRAM>\n``` \n. Please detect all the xss bugs in it by reasoning the program step by step."
    ],
    "output_constraints": [
      "Your output should be in the following format:",
      "The first line shows the number of the xss bugs in the program. Starting from the second line, you should list each bug line by line. Each line indicates how a xss bug forms."
    ],
    "output_examples": [
      "Here is an example of the output:",
      "System:",
      "There are 2 bugs in the program:",
      "Bug 1: The value of data at the line 1 is produced by the return value of getParameter. It makes the parameter of println sensitive at the line 10. Hence, there is the XSS bug at the line 2.",
      "Bug 2: The value of data at the line 3 is assigned by the return value of getProperty. It makes the parameter of println sensitive at the line 12. Hence, there is the XSS bug at the line 12.",
      ""
    ]
}